# Intro_to_RSA
My friend just sent me an encrypted message along with the values <i>d</i> and <i>n</i>. I'm not sure what to do with them.

FILE: 

## Initial Analysis 
For this challenge, we were given a file  that contained RSA parameters.

### RSA parameters
```python
ct=3720007339688023229812594223344430316061326897881472878323949245753890880668276347703123357743157548190155093637491308585195182202167118769880983604151432122774987763617713780380977753335191849737308388553523406710979326219243709000885564538773219432343065322075917550297069361528668010818789691916730335788113913983901182892666885545593959606275604605746843043885937594695871143176705645015877636935490685484039586875043912466834917346601688925558706454912365915498825094264669979978753414309581343387358573615452618226462343720609775091530725770642859088256319623550210858335980499083008186811062813458458470085992
n=23568321690349165058219784198609106304401431793682026967757306010948160447641891529303859986365453946238396175575236386468270999209539443607269502314108672090733199346396030719627217585331592380563563494314870974330067626948806014377440108638171744335516193102177843623767266527964199627858678249581843834475014501306586644149892816551943186079134525801984824509268396163149150907464540518912771481800213270504472126658276074460272288171646462487217964647891723997492887217322820445018881170435130845482618323311943985381765958314269976673915570829081912037587345678571749092010530319267564567400245479819421490665427
d=9844917750202156684526676720343056505322086711076783653040633678009625713942420655602521796645264007083362584533128939621212244600154901936198023946031081788240414808534686314303595047317357721749669869239725770072782265824656506242226534844112328500375227770041665731483783030494955963993761932351992871394473220606944376558077078848832229613945553492100532330512108440404255817755595996109380975434842944541869101687706117795019039696890296375291855863622327269581792240404994890330461534699692079479053669067708294360217056985558961184505130238238933443096798011337282863017090215930266726404251827625603036310401
```

## Tools 
* powmod() from gmpy2 (python)
* long_to_bytes form Crypto.Util.number (python)

## Computing the Answer 
### Read the RSA parameters from `rsa_values` file
```python
with open('rsa_values') as f:
    values = [l.strip() for l in f]

for val in values:
    print val
    exec(val)
```

### Decrypt the ciphertext using the provided parameters
```python
pt = gmpy2.powmod(ct, d, n)
p = long_to_bytes(pt)
```

#### hack_intro_to_rsa.py
```python
# coding: utf-8
from Crypto.Util.number import *
import gmpy2
import re

def red(prt):
    return "\033[91m{}\033[00m".format(prt)
def grn(prt):
    return "\033[92m{}\033[00m".format(prt)
def cyn(prt):
    return "\033[96m{}\033[00m".format(prt)
def flag(stuff):
    inner = re.search(r"\{.+\}", stuff).group()
    return  stuff.replace('UDCTF', cyn('UDCTF')).replace(inner.strip('{}'), red(inner.strip('{}'))).replace('{', grn('{')).replace('}', grn('}'))

with open('rsa_values') as f:
    values = [l.strip() for l in f]

for val in values:
    # print val
    exec(val)

# we have d, ct, n
pt = gmpy2.powmod(ct, d, n)
p = long_to_bytes(pt)

print flag(p)
with open('flag.txt', 'w') as f:
    f.write(flag(p)+'\n') 
```

### RESULTS
```Mask
âžœ  intro_to_rsa git:(master) python hack_intro_to_rsa.py

UDCTF{y0u_kn0w_RSA!!!}
```

## The Flag 
```ObjectScript
UDCTF{y0u_kn0w_RSA!!!}
```
